<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>成绩分析</title>
    <meta charset="UTF-8">
    <title>analyse</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body onload="init()">
<style type="text/css">
    a.hand:hover   {cursor:hand}
</style>
<style>
    .examContentWrap {
        background: #fff;
        padding: 25px 40px 0;
        margin-bottom: 20px;
        border: 1px solid #DEDEDE;
    }
    .examContentWrap {
        background: #fff;
        padding: 25px 40px 0;
        margin-bottom: 20px;
        border: 1px solid #DEDEDE;
    }
    .examContentTitle, .testAnalysisTitle, .questionAnalysisTitle{
        margin-bottom: 20px;
        font-size: 20px;
        color:  #27274A;
        border-bottom: 1px solid #DBDDE6;
        padding-bottom: 25px;
    }
    .examContent .form-row {
        margin-bottom: 20px;
    }
    .examContent .form-row .title {
        color: #9090A4;
        display: inline-block;
        width: 70px;
    }
    .examContent .form-row .content {
        color: #4A4A4A;
    }
    .examContent .form-row .content.active {
        color: #1A8CFE;
        cursor: pointer;
        text-decoration: underline;
    }
    .free-trail-modal .modal-dialog {
        width: 600px;
        margin: 15vh auto;
        border-radius: 10px;
        overflow: auto;
    }
    .free-trail-modal .modal-content {
        padding: 0;
        border-radius: 10px;
        border: none;
    }
    /* modal header */
    .free-trail-modal .modal-content .modal-header {
        height: auto;
        padding: 0;
        position: relative;
        background: url("https://s4.kaoshixing.com/static/vue/images/free-trail/free-trail-dialog-bg.png?v=07505532b2") center/cover;
        text-align: center;
    }
    .free-trail-modal .modal-content .modal-header > .image {
        width: 100px;
        height: 121px;
        margin: 25px auto 0;
    }
    .free-trail-modal .modal-content .modal-header .title {
        font-size: 20px;
        line-height: 28px;
        color: #fff;
        padding: 7px 0 22px;
    }
    .free-trail-modal .modal-content .modal-header .title .image {
        width: 22px;
        height: 22px;
        vertical-align: -5px;
    }
    /* modal body */
    .free-trail-modal .modal-content .modal-body {
        padding: 40px 50px;
        margin: 0;
        overflow: auto;
        text-align: left;
    }
    .free-trail-modal .modal-content .modal-body .list .list-item {
        font-size: 16px;
        line-height: 22px;
        color: #27274a;
        padding: 0 0 0 20px;
    }
    .free-trail-modal .modal-content .modal-body .list .list-item::before {
        content: "";
        display: inline-block;
        width: 12px;
        height: 12px;
        margin-left: -12px;
        transform: translateX(-8px);
        background: #cadaff;
        border-radius: 50%;
    }
    .free-trail-modal .modal-content .modal-body .list .list-item .strong {
        color: #1269ff;
        font-weight: 500;
    }
    /* modal footer */
    .free-trail-modal .modal-footer {
        text-align: center;
        padding: 0 0 30px;
        border: none;
    }
    .free-trail-modal .modal-footer .btn {
        font-size: 18px;
        line-height: 25px;
        padding: 10px 54px;
        border: none;
        border-radius: 24px;
        background: linear-gradient(to right, #1b75ff, #0058ff);
    }
</style>
<div class="viewFrameWork sidebar-full" id="viewFrameWork">
    <div class="body-toolbar clearfix">
        <ul class="scoreAnalysisContentBar ksx-tabs-card">
            <li class="active scoreAnalysisBarOne ksx-tab-item" id="score">
                <button type="button"
                        class="btn btn-default "
                        onclick="search()">查看学生成绩单</button>
            </li>
            <li class="scoreAnalysisBarTwo ksx-tab-item" id="scoreInterval">
                <a href="javascript:void(0);">
                    分数段统计
                </a>
            </li>
            <li class="scoreAnalysisBarThree ksx-tab-item" id="scoreExamine">
                <a href="javascript:void(0);">学员信息</a>
            </li>
        </ul>
    </div>
</div>
<div class="exam shadow-lg p-3 mb-5 bg-white rounded" >
    <div class="scoreAnalysis">
        <div class="examContentWrap">
            <div id="examId"></div>
            <div class="examContentTitle content examName" id="examName">考试科目</div>
            <div class="examContent">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-row">
                            <span class="title">总分:</span>
                            <span id="examTotalScore"></span>分
                        </div>
                        <div class="form-row">
                            <span class="title">及格分:</span>
                            <span id="passMark"></span>分
                        </div>

                        <div class="form-row">
                            <span class="title">答题时长:</span>
                            <span id="examTime"></span>
                        </div>
                        <div class="form-row">
                            <span class="title">考试时间:</span>
                            <span id="examTimeInterval"></span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-row">
                            <span class="title">应考人数:</span>
                            <span id="examineNums"></span>
                        </div>
                        <div class="form-row">
                            <span class="title">平均分:</span>
                            <span id="avgScore"></span>分
                        </div>
                        <div class="form-row">
                            <span class="title">最高分:</span>
                            <span id="maxScore"></span>分
                        </div>
                        <div class="form-row">
                            <span class="title">最低分:</span>
                            <span id="minScore"></span>分
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <!--全班成绩统计-->
        <div class="score tabContent">
            <div class="scoreAnalysisFun clear">
                <div class="scoreAnalysisGrid">
                    <button type="button" class="btn btn-default export scoreExport pull-right" id="scoreExport">导出答题情况</button>
                    <table id="scoreAnalysis-grid-data" class="table">
                        <thead>
                        <tr>
                            <th id="department">班级</th>
                            <th id="examineNum">应考人数</th>
                            <th id="passPercent">及格率</th>
                            <th id="max-Score">最高分</th>
                            <th id="min-Score">最低分</th>
                            <th id="avg-Score">平均分</th>
                        </tr>
                        </thead>
                        <tbody id="data">
                        </tbody>
                        <tfoot>
                        <tr id="table bottom" class="table-bordered">
                            <td colspan=5">
                                <div id="page_div">
                                    <div id="right">
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
        </br>
        </br>
        <div class="col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped mb-0" align="center">
                            <thead>
                            <tr>
                                <th align="right" colspan="3">考试排名</th>
                                <th align="right" colspan="1">学生姓名</th>
                                <th align="right" colspan="1">总分</th>
                            </tr>
                            </thead>
                            <tbody id="data1">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <!--分数段统计-->
        <div class="scoreInterval scoreIntervalChart hidden tabContent">
            <div class="scoreInterval scoreIntervalChart hidden tabContent">
                <div class="funRight pull-right">
                    <button type="button" class="btn btn-default funBtn scoreIntervalSetting">分数段设置</button>
                    <button type="button" class="btn btn-default funBtn scoreIntervalChartSwitch" id="pie">饼状图</button>
                    <button type="button" class="btn btn-default export scoreIntervalExport">导出</button>

                </div>
                <div class="scoreIntervalChartWrap">
                    <div class="scoreIntervalChart" id="scoreIntervalChart" style="height: 500px;">

                    </div>
                </div>
            </div>
        </div>




    </div>

</div>
<script>
    function init(){
        var examId = sessionStorage.getItem("id");
        var examName=sessionStorage.getItem("examName");
        var startTime=sessionStorage.getItem("startTime");
        var testTime=sessionStorage.getItem("testTime");
        var totalScore=sessionStorage.getItem("totalScore");
        jQuery("#examName").html(examName);
        jQuery("#examTimeInterval").html(startTime);
        jQuery("#examTime").html(testTime);
        jQuery("#examTotalScore").html(totalScore);
        jQuery("#passMark").html(totalScore*0.6);
        sessionStorage.setItem("examId",examId);
        var param={
            "examId":examId
        };
        console.log(param);
        jQuery.post("/teacher/analyse/count",param,function(data){
            console.log(data);
            jQuery("#examineNums").html(data);
        })
        jQuery.post("/teacher/analyse/max",param,function (max){
            jQuery("#maxScore").html(max);

        })
        jQuery.post("/teacher/analyse/min",param,function (min){
            jQuery("#minScore").html(min);
        })
        jQuery.post("/teacher/analyse/avg",param,function (avg){
            jQuery("#avgScore").html(avg);

        })
        jQuery.post("/teacher/analyse/findStuList",param,function(rst){
            var arrs=rst.list;
            var trs="";
            for(var i=0;i<arrs.length;i++) {

                //获取每一行对应的用户对象
                var u=arrs[i];

                //循环一次一行数据
                //使用反引号,用于定义模板

                trs+=`
                    <tr>
                        <td>1</td>
                        <td colspan="1" onclick="find('${u.examId}'))">${u.username}</td>
                        <td colspan="1" onclick="find('${u.examId}'))">${u.totalScore}</td>

                    </tr>
                    `;

            }
            //把根据数据构建的行添加到表格
            jQuery("#data1").html(trs);
        })

    }

</script>

<script>
    function search(){
        window.location.href="stuList.html";
    }
</script>

</body>


</html>