<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>待审核列表</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
</head>
<body>
<div id="container">
    <div id="top">
        <blockquote class="blockquote text-center unselectable">
            <h2>
                待审核列表 <span id="countnew"></span>
            </h2>
        </blockquote>
    </div>
    <div id="middle">
        <form id="emailForm">
            <table class="table table-striped table-hover "><!--table-striped-->
                <thead>
                <tr id="tabletitle" class="unselectable">
                    <td><input type="checkbox" id="chAll"
                               onclick="selectAllCk(this.checked)"></td>
                    <td>题目描述</td>
                    <td>科目</td>
                    <td>类型</td>
                    <td>时间</td>
                </tr>
                </thead>
                <tbody id="data">

                </tbody>
                <tfoot>
                <tr id="tablebottom">
                    <td colspan="5">
                        <div id="page_div">
                            <div id="left">
                                <button type="button"
                                        class="btn btn-warning"
                                        onclick="showPassDialog()">批量通过</button>
                                <button type="button"
                                        class="btn btn-warning"
                                        onclick="showFailDialog()">批量驳回</button>
                                <button type="button"
                                        class="btn btn-danger"
                                        onclick="showDeleteDialog()">彻底删除</button>
                            </div>
                            <div id="right">

                            </div>
                        </div>
                    </td>
                </tr>

                </tfoot>
            </table>
        </form>

    </div>
</div>

<script>
    function selectAllCk(f) {
        //找页面控件名为input的并且name=ids的控制
        //设置控件的属性 checked=f
        jQuery("input[name='ids']").prop("checked",f);
    }
</script>

<script>
    function init() {
        var param = {};
        jQuery.post("/admin/needExamine/findAll", param, function (rst) {
            var arrs = rst.list;
            var trs = "";
            for (var i = 0; i < arrs.length; i++) {
                var u = arrs[i];
                //反引号定义模板
                trs += `
                <tr class="unselectable">
                <td>
                    <input type="checkbox" name="ids" value="${u.id}">
                </td>
                <td onclick="gotoSubject('${u.id}')">${u.description}</td>
                <td onclick="gotoSubject('${u.id}')">${u.subject}</td>
                <td onclick="gotoSubject('${u.id}')">${u.type}</td>
                <td onclick="gotoSubject('${u.id}')">${u.date}</td>
            </tr>
            `;
            }
            jQuery("#data").html(trs);

        })
        jQuery(function () {
            init();
        })
    }
</script>

<!--showDeleteDialog-->
<script>
    function showDeleteDialog() {
        var arrs=jQuery("input[name='ids']:checked").length;
        if(arrs>0){
            alert("deleted");
        }else{
            alert("您还未选择所要删除的题目");
        }

    }
</script>
<script>
    function showPassDialog() {
        var arrs=jQuery("input[name='ids']:checked").length;
        if(arrs>0){
            alert("passed");
        }else{
            alert("您还未选择所要通过的题目");
        }

    }
    function showFailDialog() {
        var arrs=jQuery("input[name='ids']:checked").length;
        if(arrs>0){
            alert("failed");
        }else{
            alert("您还未选择所要驳回的题目");
        }

    }
</script>
<!--gotoSubject-->
<script>
    function gotoSubject(id) {
        var param={
            "id":id
        };
        jQuery.post("/admin/needExamine/findSubject",param,function (rst) {
            var ar = rst;
            var uu;
            for (var i = 0; i < 1; i++) {//ar.length
                uu = ar[i];
                var id=uu.id;
                var description=uu.description;
                var date=uu.date;
                var subject=uu.subject;
                var type=uu.type;
                var param2={"id":id,"description":description,"date":date,"subject":subject,"type":type};
                var form={"id":param2.id};
                <!--alert("111");-->
                jQuery.post("receivebox/begainRead",form,function (rst) {
                })
                //
                window.location.href="examine_exercises.html";
            }

        })

        //location.href='showEmail.html';
    }
</script>
<!--deleteEmail-->
<script>
    function deleteEmail() {
        jQuery("#deleteDialog").modal('hide');
        var form=jQuery("#emailForm").serialize();
        <!--alert("111");-->
        jQuery.post("receivebox/deleteEmail",form,function (rst) {
            if(rst>0){
                alert("删除成功");
                pageNum=1;
                init();
            }else{
                alert("删除失败");
            }
        })
    }
</script>

<script>
    function truedelete(){
        var form={};
        jQuery.post("receivebox/needdelete",form,function () {

        })
    }
</script>
<script>
    function dangerDeleteEmail() {
        jQuery("#dangerDialog").modal('hide');
        var form=jQuery("#emailForm").serialize();
        <!--alert("111");-->
        jQuery.post("/receivebox/dangerDeleteEmail",form,function (rst) {
            if(rst>0){
                truedelete();
                alert("删除成功");
                pageNum=1;
                init();
            }else{
                alert("删除失败");
            }
        })
    }
</script>
<script>
    function isReadEmail() {
        jQuery("#isReadDialog").modal('hide');
        var form=jQuery("#emailForm").serialize();
        <!--alert("111");-->
        jQuery.post("/receivebox/isReadEmail",form,function (rst) {
            if(rst>0){
                alert("修改成功");
                pageNum=1;
                init();
            }else{
                alert("修改失败");
            }
        })
    }
</script>
</body>
</html>